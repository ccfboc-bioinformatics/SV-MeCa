myConda = '/projects/ag-fbz/rnkouame/software/miniconda3/envs'
params {
    results = '/projects/ag-fbz/rnkouame/SV-MeCa/results'
    input = '/projects/ag-fbz/rnkouame/SV-MeCa/data/input.bam'
    //input = '/projects/ag-fbz/rnkouame/SV-MeCa/data/input.chr21_22.bam'
    reference = '/projects/ag-fbz/rnkouame/SV-MeCa/data/hs37d5.fa'
    //reference = '/projects/ag-fbz/rnkouame/SV-MeCa/data/hs37d5.chr21_22.fa'
    exclude_bed = '/projects/ag-fbz/rnkouame/SV-MeCa/data/b37.lumpy.exclude.bed'
    sonic_file = '/projects/ag-fbz/rnkouame/SV-MeCa/data/human_g1k_v37.sonic'
}



process{
    executor = 'slurm'
    clusterOptions = '--account=unikoeln'
	queue = 'fbz'
    cache = 'lenient'

    
    withName: REFERENCE_INDEX {
        conda = "${myConda}/samtools"
        cpus = 1
        memory = {4.GB * task.attempt}
        errorStrategy = 'retry'
        maxRetries = 1
        time = '72h'
    }
    withName: BAM_INDEX {
        conda = "${myConda}/samtools"
        cpus = 8
        memory = {8.GB * task.attempt}
        errorStrategy = 'retry'
        maxRetries = 1
        time = '72h'
    }
    withName: BREAKDANCER {
        conda = "${myConda}/breakdancer"
        cpus = 4
        memory = {8.GB * task.attempt}
        errorStrategy = 'retry'
        maxRetries = 1
        time = '72h'
    }
    withName: MANTA {
        conda = "${myConda}/manta"
        cpus = 16
        memory = {16.GB * task.attempt}
        errorStrategy = 'ignore'
        maxRetries = 1
        time = '72h'
    }
    withName: LUMPY {
        conda = "${myConda}/smoove"
        cpus = 4
        memory = {8.GB * task.attempt}
        errorStrategy = 'retry'
        maxRetries = 1
        time = '72h'
    }
    withName: DELLY {
        conda = "${myConda}/delly"
        cpus = 4
        memory = {8.GB * task.attempt}
        errorStrategy = 'retry'
        maxRetries = 1
        time = '72h'
    }
    withName: PINDEL_SINGLE {
        conda = "${myConda}/pindel"
        cpus = 8
        memory = {16.GB * task.attempt}
        errorStrategy = 'retry'
        maxRetries = 1
        time = '72h'
    }
    withName: MERGE_PINDEL_SINGLE {
        conda = "${myConda}/samtools"
        cpus = 8
        memory = {16.GB * task.attempt}
        errorStrategy = 'retry'
        maxRetries = 1
        time = '72h'
    }
    withName: TARDIS_PREP {
        conda = "${myConda}/smoove"
        cpus = 8
        memory = {16.GB * task.attempt}
        errorStrategy = 'retry'
        maxRetries = 1
        time = '72h'
    }
    withName: TARDIS {
        container = "/projects/ag-fbz/rnkouame/SV-MeCa/bin/tardis_latest.sif"
        cpus = 8
        memory = {16.GB * task.attempt}
        errorStrategy = 'ignore'
        maxRetries = 1
        time = '72h'
    }
}

singularity {
    enabled = true 
    autMounts = true
    engineOptions = "-d"
}
trace {
    enabled = true
    file = 'trace.tsv'
    fields = 'task_id, hash, native_id, name, status, attempt, exit, realtime, cpus, %cpu, memory, %mem, rss, vmem, peak_rss, peak_vmem'
}
